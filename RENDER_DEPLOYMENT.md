# Render Deployment Guide

This guide will help you deploy the StyleHub full-stack application to Render.

## Prerequisites

1. A Render account (sign up at [render.com](https://render.com))
2. MongoDB Atlas database (already configured in the project)
3. Git repository (GitHub, GitLab, or Bitbucket)

## Deployment Steps

### Option 1: Using render.yaml (Recommended)

1. **Push your code to Git repository**
   - Make sure all changes are committed and pushed to your repository

2. **Connect Repository to Render**
   - Log in to Render dashboard
   - Click "New +" → "Blueprint"
   - Connect your Git repository
   - Render will automatically detect the `render.yaml` file

3. **Set Environment Variables**
   - In the Render dashboard, go to your service settings
   - Add the following environment variable:
     - `MONGODB_URI`: `mongodb+srv://stylehub_user:stylehub_user@stylehub.fmxjjhd.mongodb.net/stylehub?retryWrites=true&w=majority&appName=stylehub`
     - `NODE_ENV`: `production` (automatically set)
     - `PORT`: Automatically set by Render

4. **Deploy**
   - Render will automatically build and deploy your application
   - The build process will:
     - Install frontend dependencies
     - Build the Angular frontend (outputs to `dist/browser`)
     - Install backend dependencies
     - Start the Node.js server

### Option 2: Manual Setup

1. **Create a New Web Service**
   - Click "New +" → "Web Service"
   - Connect your Git repository

2. **Configure Build Settings**
   - **Environment**: Node
   - **Build Command**: 
     ```bash
     cd stylehub_fullstack_complete/frontend && npm install && npm run build && cd ../backend && npm install
     ```
   - **Start Command**: 
     ```bash
     cd stylehub_fullstack_complete/backend && node index.js
     ```

3. **Set Environment Variables**
   - `MONGODB_URI`: Your MongoDB connection string
   - `NODE_ENV`: `production`
   - `PORT`: Auto-generated by Render

4. **Deploy**
   - Click "Create Web Service"
   - Render will build and deploy your application

## Architecture

The application is deployed as a single web service:

- **Backend**: Express.js server that serves both API endpoints and static frontend files
- **Frontend**: Angular application built and served as static files from the backend
- **Database**: MongoDB Atlas (external service)

## File Structure After Build

```
stylehub_fullstack_complete/
├── backend/
│   ├── index.js (serves API + static files)
│   └── node_modules/
└── frontend/
    └── dist/
        └── browser/ (Angular production build)
```

## Environment Variables

### Required Variables

- `MONGODB_URI`: MongoDB Atlas connection string
- `PORT`: Automatically set by Render (defaults to 3000 locally)
- `NODE_ENV`: Set to `production` in Render

### How It Works

1. The backend uses `process.env.PORT` (set by Render) to listen on the correct port
2. The backend serves the Angular app from `frontend/dist/browser`
3. API requests are routed to `/api/*` endpoints
4. All other routes serve the Angular `index.html` for client-side routing

## Troubleshooting

### Build Fails

- Check that Node.js version is compatible (Render uses Node 18+ by default)
- Verify all dependencies are listed in `package.json`
- Check build logs for specific errors

### API Not Working

- Verify `MONGODB_URI` environment variable is set correctly
- Check that MongoDB Atlas allows connections from Render IPs (0.0.0.0/0)

### Frontend Not Loading

- Verify frontend build completed successfully
- Check that `dist/browser` directory exists after build
- Verify backend is serving static files correctly

### CORS Issues

- CORS is configured to allow all origins in development
- For production, consider restricting to your Render domain

## Custom Domain

1. In Render dashboard, go to your service
2. Click "Settings" → "Custom Domains"
3. Add your domain and follow DNS configuration instructions

## Monitoring

- Check Render dashboard for logs and metrics
- Set up alerts for service failures
- Monitor MongoDB Atlas for database performance

## Cost

- Free tier includes 750 hours/month
- Database is external (MongoDB Atlas free tier available)

## Support

For issues with:
- **Render**: Check [Render documentation](https://render.com/docs)
- **Application**: Check application logs in Render dashboard
- **MongoDB**: Check MongoDB Atlas dashboard

